# Item59. 라이브러리를 익히고 사용하라

```java
static Random rnd = new Random();

static int random(int n) {
    return Math.abs(rnd.nextInt()) % n;
}

```

위 코드는 괜찮은 듯 보여도 세 가지 문제를 내포하고 있다.
1. n이 그리 크지 않은 2의 제곱수라면 얼마 지나지 않아 같은 수열이 반복된다.
2. n이 2의 제곱수가 아니라면 몇몇 숫자가 평균적으로 더 자주 반환된다.

```java
public static void main(String[] args) {
    int n = 2 * (Integer.MAX_VALUE / 3);
    int low = 0;
    for (int i=0; i<1000000; i++) {
        if (random(n) < n/2) {
            low++;
        }
    }

    System.out.pringln(low);
}

```

위 메서드가 이상적으로 동작한다면 약 50만개가 출력돼야 하지만, 실제로 돌려보면 666,666에 가까운 값을 얻는다.

3. 지정한 범위 '바깥' 수가 종종 튀어나올 수 있다.
   rnd.nextInt() 가 반환한 값을 Math.abs 를 이용하여 음수가 아니라 정수로 매핑하기 때문이다.
   nextInt 가 Integer.MIN_VALUE 를 반환하면 Math.abs도 Integer.MIN_VALUE 를 반환하고, 모듈러 연산자는 음수를 반환해버린다.


위 같은 문제를 해결하려면 의사난수 생성기, 정수론, 2의 보수 계산 등에 조예가 깊어야 한다. 하지만 Random.nextInt(int) 가 이미 해결해두었다. 

1. 표준라이브러리를 사용하는 첫 번째 이점은 표준라이브러리를 활용하면 그 코드를 작성한 전문가의 지식과 여러분보다 앞서 사용한 다른 프로그래머들의 경험을 활용할 수 있다.

자바7 부터는 Random을 더 이상 사용하지 않는 것이 좋다.
ThreadLocalRandom 으로 대체하면 더 빠르고 더 고품질의 무작위 수를 생성한다.
포크-조인 풀이나 병렬 스트림에서는 SplittableRandom을 사용하라.

2. 표준라이브러리를 사용하는 두번째 이점은, 핵심적인 일과 크게 관련 없는 문제를 해결하느라 시간을 허비하지 않아도 된다는 것이다. 
3. 세 번째는 따로 노력하지 않아도 성능이 지속해서 개선된다는 점이다. 
4. 네 번째는 기능이 점점 많아진다는 것이다. 라이브러리에 부족한 부분이 있다면 개발자 커뮤니티에서 이야기가 나오고 논의된 후 다음 릴리스에 해당 기능이 추가되곤 한다.
5. 마지막은 우리가 작성한 코드가 다른 사람에게 낯 익은 코드가 된다.


그러나 많은 개발자들이 이런 기능을 직접 개발해서 사용하고 있다. 아마도 라이브리러에 이런 기능이있는지 모르게 때문일 것이다. 
자바는 메이저 릴리즈마다 새로운 기능을 설명한웹페이지를 공시한다. [java8-feat]. [java9-feat]

라이브러리가 방대하여 모든 API 문서를 공부하기는 벅차겠지만 자바 프로그래머라면 적어도 java.lang, java.util, java.io 와 그 하위 패키지들에는 익숙해져야 한다.


때때로 라이브러리가 여러분에게 필요한 기능을 충분히 제공하지 못할 수 있다.